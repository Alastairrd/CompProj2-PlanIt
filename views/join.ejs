<!DOCTYPE html>
<html lang="en">
	<head>
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<meta name="description" content="Calendar allowing friend of creator of PlanIt event to join and put in their unavailability and save it.">
		<title>PLANIT Join Event</title>
		<link rel="stylesheet" type="text/css" href="/main.css" />
		<script src="/scripts.js"></script>
		<script>
			let eventUrl = <%- JSON.stringify(eventUrl) %>;
		</script>
	</head>
	<body>
		<main id="nameSection" style="display: block">
			<!-- Inside the main id so that progress bar can shift properly -->
			<section class="page-top">
				<!-- Heading-->
				<h1 class="title-heading">PlanIt MVP</h1>
		
		
				<!-- Progress bar -->
				<div class="progress-grey">
					<div class="progress-blue-40"></div>
				</div>

				<!-- Back button -->
				<button class="back-button" onclick="homePage()">Back</button> <!-- TODO check this goes back to the right place -->
			</section>
			<section class="content">
				<!-- Welcome message for join section -->
				<section class="text">
					<p class="bold">Welcome to PlanIt</p>
					<p>Enter your name in here:</p>
					<p></p>
				</section>
				<form action="javascript:;" onsubmit="showCalendar()">
					<fieldset>
						<legend>Name</legend>
						<input
							type="text"
							id="name"
							name="name"
							minlength="2"
							maxlength="50"
							pattern="^[A-Za-z]+$"
							oninvalid="setCustomValidity('Min 2 characters, max 50 characters, no special characters, numbers or spaces - only letters.');"
							oninput="setCustomValidity('')"
							required
						/>
					</fieldset>
					<button type="submit" class="next"><span>Next</span></button>
				</form>
			</section>
		</main>

		<!-- TODO: What is this bit? Why does it have its own main and id? progressSection?-->
		<main id="progressSection">
			<section class="page-top">
				<!-- Heading-->
				<h1 class="title-heading">PlanIt MVP</h1>
		
		
				<!-- Progress bar -->
				<div class="progress-grey">
					<div class="progress-blue-20"></div>
				</div>
			</section>
		</main>


		<main id="Calendar" style="display: none">
			<section class="page-top">
				<!-- Heading-->
				<h1 class="title-heading">PlanIt MVP</h1>
		
				<!-- Progress bar -->
				<div class="progress-grey">
					<div class="progress-blue-80"></div>
				</div>

				<!-- Back button -->
				<button class="back-button" onclick="homePage()">Back</button> <!-- TODO: this should take them back to the code inputting bit or shouldn't exist-->
			</section>
			<section class="content">
				<!-- Instruction message -->
				<section class="text">
					<p>
						Swipe the times you <em>can't</em> do. <br />Click 'Next'
						when you're done to share with others:
					</p>
					<!-- Calendar and explanation button -->
					<div class="question">?</div>
				</section>

				<!-- EXPERIMENTATION -->
				<div class="grid-containment">
					<div class="main-grid">
						<!-- FOR EVERY COLUMN -->
						<!--todo remove -1-->
						<div class="day">
							<!--need a date and day of week for sizing-->
							<div class="dayslot" id="hidden-corner">
								<h1 class="date"><%=dates[0].date %></h1>
								<h2 class="date"><%=dates[0].dayOfWeek %></h2>
							</div>

							<!-- EVERY TIME PERIOD OF THE DAY -->
							<div class="timeOfDay">09:00</div>
							<div class="timeOfDay">10:00</div>
							<div class="timeOfDay">11:00</div>
							<div class="timeOfDay">12:00</div>
							<div class="timeOfDay">13:00</div>
							<div class="timeOfDay">14:00</div>
							<div class="timeOfDay">15:00</div>
							<div class="timeOfDay">16:00</div>
							<div class="timeOfDay">17:00</div>
						</div>

						<% for(var i = 0; i < dates.length ; i++) { %>

						<div class="day" id="day<%=i%>">
							<!-- FOR EVERY SLOT IN THE ROW -->
							<!--todo remove hardcoded 10 with variable for timeslots-->
							<% for(var j = 0; j < 10; j++) { %>

							<!-- IF IT IS THE FIRST ITEM IN THE COLUMN, MAKE IT THE DATE -->
							<% if(j==0) { %>
							<div class="dayslot">
								<h1 class="date">
									<%=dates[i].date %>
									<span class="monthSpan"
										><%=dates[i].month %></span
									>
								</h1>
								
								<h2 class="date"><%=dates[i].dayOfWeek %></h2>
							</div>

							<!-- IF NOT THE FIRST COLUMN, FILL AS TIMESLOT -->
							<% } else { %>
							<div class="timeslot">1</div>
							<% } %> <% } %>
						</div>
						<% } %>
					</div>
				</div>
				<!-- Next button at bottom of page-->
				<button class="next" onclick="addAvailToEvent()"><span>NEXT</span></button>
			</section>
		</main>

		<!--skip button-->
		<main id="landingSection">
			<a href="http://www.doc.gold.ac.uk/usr/717/summary/<%- eventUrl %>">
				<button class="join" style="left: 20%">
					Skip to results
				</button>
			</a>
		</main>
	</body>
</html>
